# 管理画面アカウント情報

## デフォルトアカウント

`database/sample-data.sql`を実行すると、以下のサンプルアカウントが作成されます。

### ⭐ サービス全体の管理者（推奨）

**サービス全体を管理する管理者アカウントです。運営者向け管理画面（`/unei/login`）でログインしてください。**

- **ユーザー名**: `admin`
- **パスワード**: `password123`
- **役割**: オーナー（owner）
- **表示名**: システム管理者
- **メール**: admin@example.com
- **管理画面**: `/unei/dashboard`（運営者向け管理画面）
- **アクセス権限**: 全店舗へのアクセス権限あり（8店舗すべてを管理可能）

**ログイン方法**:
1. トップページから「運営者向け管理ページ」をクリック
2. または `/unei/login` に直接アクセス
3. 上記のアカウント情報でログイン
4. 自動的に `/unei/dashboard` にリダイレクトされます

**注意**: このアカウントは全店舗を管理できるため、店舗スタッフ用のログイン画面（`/staff/login`）でもログインできますが、運営者向け管理画面（`/unei/login`）を使用することを推奨します。

### ユーザー一覧（店舗ユーザー5人）

#### ユーザー1: 複数店舗オーナー
- **ユーザー名**: `owner_multi`
- **パスワード**: `password123`
- **役割**: オーナー（owner）
- **表示名**: 山田 太郎
- **メール**: yamada@example.com
- **所属店舗**: shop001（レストラン イタリアン）、shop002（カフェ モカ）
- **管理画面**: `/multi-shop/dashboard`（複数店舗統合管理画面）

#### ユーザー2: 和食店オーナー
- **ユーザー名**: `owner_sakura`
- **パスワード**: `password123`
- **役割**: オーナー（owner）
- **表示名**: 佐藤 花子
- **メール**: sato@example.com
- **所属店舗**: shop003（和食 さくら）

#### ユーザー3: バーガーショップマネージャー
- **ユーザー名**: `manager_beef`
- **パスワード**: `password123`
- **役割**: マネージャー（manager）
- **表示名**: 鈴木 一郎
- **メール**: suzuki@example.com
- **所属店舗**: shop004（バーガーショップ ビーフ）

#### ユーザー4: パスタハウススタッフ
- **ユーザー名**: `staff_mamma`
- **パスワード**: `password123`
- **役割**: スタッフ（staff）
- **表示名**: 田中 次郎
- **メール**: tanaka@example.com
- **所属店舗**: shop005（パスタハウス マンマ）

#### ユーザー5: 複数店舗オーナー（プレミアム系）
- **ユーザー名**: `owner_premium`
- **パスワード**: `password123`
- **役割**: オーナー（owner）
- **表示名**: 伊藤 三郎
- **メール**: ito@example.com
- **所属店舗**: shop006（ステーキハウス プレミアム）、shop007（ラーメン屋 こだわり）、shop008（スイーツカフェ スイート）
- **管理画面**: `/multi-shop/dashboard`（複数店舗統合管理画面）

### 店舗一覧（8店舗）

1. **shop001**: レストラン イタリアン（15メニュー）
2. **shop002**: カフェ モカ（12メニュー）
3. **shop003**: 和食 さくら（13メニュー）
4. **shop004**: バーガーショップ ビーフ（13メニュー）
5. **shop005**: パスタハウス マンマ（12メニュー）
6. **shop006**: ステーキハウス プレミアム（13メニュー）
7. **shop007**: ラーメン屋 こだわり（11メニュー）
8. **shop008**: スイーツカフェ スイート（11メニュー）

**合計**: 100メニュー

## ログイン方法

### サービス全体の管理者（運営者向け管理画面）

1. トップページから「運営者向け管理ページ」をクリック
2. または `/unei/login` に直接アクセス
3. ユーザー名: `admin`、パスワード: `password123` でログイン
4. 自動的に `/unei/dashboard` にリダイレクトされます

**このアカウントでできること**:
- 全店舗の一覧表示・管理
- 全ユーザーの一覧表示・管理（将来的に）
- システム全体の統計情報の確認

### 店舗スタッフ用管理画面

1. トップページから「店舗スタッフ用」をクリック
2. または `/staff/login` に直接アクセス
3. 上記のアカウント情報でログイン
4. ログイン後、店舗選択画面が表示されます
5. 所属店舗を選択してダッシュボードへ進みます

**複数店舗オーナーの場合**:
- 自動的に `/multi-shop/dashboard` にリダイレクトされます
- 複数店舗を一元管理できます

## 権限について

### サービス管理者（admin）
- 全店舗へのアクセス権限
- 店舗の追加・編集・削除（将来的に）
- 全ユーザーの管理（将来的に）
- システム全体の統計情報の確認

### owner（オーナー）
- 店舗の全権限
- スタッフの追加・編集・削除
- スタッフの役割変更
- メニュー管理
- 注文管理
- 会計管理

### manager（管理者）
- スタッフの追加・編集
- スタッフの有効/無効切り替え
- スタッフのパスワード変更
- メニュー管理
- 注文管理

### staff（スタッフ）
- 自分の情報の閲覧・編集
- 自分のパスワード変更
- 注文管理（ステータス更新）

## パスワードの変更

ログイン後、以下の方法でパスワードを変更できます：

### 自分のパスワード変更

**URL**: `/shop/users/password`

**アクセス方法**:
1. 各管理画面のナビゲーションバーにある「パスワード変更」リンクをクリック
2. または、直接 `/shop/users/password` にアクセス

**必要な情報**:
- 現在のパスワード
- 新しいパスワード（6文字以上）
- 新しいパスワード（確認用）

### 他のスタッフのパスワード変更（管理者のみ）

**URL**: `/shop/users/{id}/password`

**アクセス方法**:
1. `/shop/users` のスタッフ一覧から、対象ユーザーの「パスワード変更」ボタンをクリック
2. または、直接 `/shop/users/{ユーザーID}/password` にアクセス

**必要な情報**:
- 新しいパスワード（6文字以上）
- 新しいパスワード（確認用）

**注意**: 管理者が他のユーザーのパスワードを変更する場合、現在のパスワードは不要です。

## セキュリティ注意事項

⚠️ **重要**: 本番環境では必ず以下の対応を行ってください：

1. **デフォルトパスワードの変更**
   - 初回ログイン後、すぐにパスワードを変更してください
   - デフォルトパスワード（`password123`）は推測されやすいため危険です

2. **強力なパスワードの設定**
   - 8文字以上
   - 大文字・小文字・数字・記号を含む
   - 辞書に載っている単語を避ける

3. **アカウントの管理**
   - 不要なアカウントは削除または無効化
   - 定期的にアカウント一覧を確認

4. **ログイン履歴の確認**
   - `/shop/users` で最終ログイン日時を確認
   - 不審なアクセスがないかチェック

## 新しいアカウントの作成

### オーナー・管理者による追加

1. `/shop/users` にアクセス
2. 「スタッフを追加」ボタンをクリック
3. 必要情報を入力：
   - ユーザー名（必須）
   - パスワード（必須、6文字以上）
   - 表示名（必須）
   - メールアドレス（任意）
   - 役割（オーナーのみ設定可能）

### データベースから直接作成

phpMyAdminで以下のSQLを実行：

```sql
-- 店舗IDを取得（例: shop001のIDを取得）
SET @shop_id = (SELECT id FROM shops WHERE code = 'shop001' LIMIT 1);

-- 新しいユーザーを作成（パスワード: newpassword123）
INSERT INTO `users` (`shop_id`, `username`, `password_hash`, `name`, `role`) 
VALUES (
  @shop_id, 
  'newuser', 
  '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi', 
  '新しいユーザー', 
  'staff'
);
```

**注意**: パスワードハッシュは `password_hash()` 関数で生成する必要があります。上記のハッシュは `password123` 用です。

## パスワードハッシュの生成方法

PHPでパスワードハッシュを生成する場合：

```php
<?php
$password = 'your_password_here';
$hash = password_hash($password, PASSWORD_DEFAULT);
echo $hash;
?>
```

または、オンラインツールを使用して生成することもできます。

## トラブルシューティング

### ログインできない場合

1. **ユーザー名・パスワードの確認**
   - 大文字・小文字を区別します
   - スペースが含まれていないか確認

2. **アカウントが有効か確認**
   ```sql
   SELECT username, is_active FROM users WHERE username = 'admin';
   ```
   `is_active` が `1` である必要があります

3. **店舗が有効か確認**
   ```sql
   SELECT u.username, s.is_active as shop_active 
   FROM users u 
   INNER JOIN shops s ON u.shop_id = s.id 
   WHERE u.username = 'admin';
   ```
   店舗の `is_active` も `1` である必要があります

4. **パスワードのリセット**
   ```sql
   -- パスワードを password123 にリセット
   UPDATE users 
   SET password_hash = '$2y$10$92IXUNpkjO0rOQ5byMi.Ye4oKoEa3Ro9llC/.og/at2.uheWG/igi' 
   WHERE username = 'admin';
   ```

## 関連ドキュメント

- [スタッフ管理機能](./STAFF_MANAGEMENT.md)
- [データベース README](./database/README.md)
- [APIサーバー README](./api-server/README.md)
- [複数店舗オーナー機能](./MULTI_SHOP_OWNER.md)
